<#
.SYNOPSIS
  Checks all hardcoded registry parameters on a server and outputs the compliance status to a CSV file.

.DESCRIPTION
  This script automatically checks all registry keys and values defined in its
  hardcoded mappings against their expected values. The results, including
  the ISBL number, a descriptive parameter name (CIS Name), the registry path,
  value name, expected value, current value, and a compliance status (Compliant,
  Non-Compliant, or Non-Configured), are written to a CSV file.

.PARAMETER OutputCsvFile
  An optional string that specifies the name of the CSV file where the results
  will be saved. If not provided, it defaults to "RegistryCheckReport.csv".

.EXAMPLE
  # Run the script to check all parameters and output to default CSV
  .\Check-AllRegistryCompliance.ps1

.EXAMPLE
  # Run the script and specify a custom output CSV file
  .\Check-AllRegistryCompliance.ps1 -OutputCsvFile "FullRegistryCompliance.csv"

.NOTES
  - The script requires administrative privileges to access certain registry keys.
  - The 'CIS Name' provides a more descriptive name for each parameter, derived
    from common security benchmarks.
  - 'Non-Configured' status indicates that either the registry path or the
    specific value name was not found on the system.
  - Some parameters from the provided CSVs were too vague to map to a specific
    registry path/value or refer to settings that require different PowerShell
    commands (e.g., service status, user rights) and have been skipped.
#>
param(
    [Parameter(Mandatory=$false)]
    [string]$OutputCsvFile = "RegistryCheckReport.csv"
)

# Hardcoded registry mappings
# Each entry includes:
# - 'CIS Name': A descriptive name for the parameter.
# - 'Path': The full registry path (e.g., HKLM:\Software\...).
# - 'ValueName': The specific registry value name to check.
# - 'ExpectedValue': The value that the registry entry should have for compliance.
$RegistryMappings = @{
    "ISBL-10564-01.009" = @{
        "CIS Name"      = "Allow Administrator account lockout"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Safer\CodeIdentifiers"
        "ValueName"     = "AllowAdminAccountLockout"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.043" = @{
        "CIS Name"      = "Replace a process level token"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Safer\CodeIdentifiers"
        "ValueName"     = "ReplaceProcessLevelToken"
        "ExpectedValue" = "LOCAL SERVICE, NETWORK SERVICE"
    }
    "ISBL-10564-01.055" = @{
        "CIS Name"      = "Domain member: Digitally encrypt secure channel data (when possible)"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\Netlogon\Parameters"
        "ValueName"     = "SealSecureChannel"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.064" = @{
        "CIS Name"      = "Interactive logon: Message text for users attempting to log on"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System"
        "ValueName"     = "LegalNoticeCaption"
        "ExpectedValue" = "Your custom message title" # Placeholder, adjust if specific title is required
    }
    "ISBL-10564-01.065" = @{
        "CIS Name"      = "Password Policy: Maximum password age"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System"
        "ValueName"     = "MaximumPasswordAge"
        "ExpectedValue" = "14"
    }
    "ISBL-10564-01.066" = @{
        "CIS Name"      = "Interactive logon: Smart card removal behavior"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System"
        "ValueName"     = "ScRemoveOption"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.073" = @{
        "CIS Name"      = "Microsoft network server: Disconnect clients when logon hours expire"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\LanmanServer\Parameters"
        "ValueName"     = "EnableForcedLogOff"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.074" = @{
        "CIS Name"      = "Microsoft network server: Server SPN target name validation level"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\LanmanServer\Parameters"
        "ValueName"     = "SmbServerNameHardeningLevel"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.079" = @{
        "CIS Name"      = "Network access: Named Pipes that can be accessed anonymously"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\LanmanServer\Parameters"
        "ValueName"     = "NullSessionPipes"
        "ExpectedValue" = "" # Expects an empty string for no pipes
    }
    "ISBL-10564-01.087" = @{
        "CIS Name"      = "Network access: Do not allow storage of credentials or .NET Passports for network authentication"
        "Path"          = "HKLM:\System\CurrentControlSet\Control\Lsa"
        "ValueName"     = "DisableDomainCreds"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.089" = @{
        "CIS Name"      = "Network security: Force logoff when logon hours expire"
        "Path"          = "HKLM:\System\CurrentControlSet\Control\Lsa"
        "ValueName"     = "ForceLogoffWhenHourExpire"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.094" = @{
        "CIS Name"      = "Network security: Audit NTLM authentication in this domain"
        "Path"          = "HKLM:\System\CurrentControlSet\Control\Lsa\MSV1_0"
        "ValueName"     = "AuditNTLMInDomain"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.095" = @{
        "CIS Name"      = "Network security: Restrict NTLM: Outgoing NTLM traffic"
        "Path"          = "HKLM:\System\CurrentControlSet\Control\Lsa\MSV1_0"
        "ValueName"     = "RestrictSendingNTLMTraffic"
        "ExpectedValue" = "2"
    }
    "ISBL-10564-01.099" = @{
        "CIS Name"      = "Windows Firewall: Domain: Firewall state"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile"
        "ValueName"     = "EnableFirewall"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.100" = @{
        "CIS Name"      = "Windows Firewall: Domain: Inbound connections"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile"
        "ValueName"     = "DefaultInboundAction"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.102" = @{
        "CIS Name"      = "Windows Firewall: Domain: Logging: Log file path"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging"
        "ValueName"     = "LogFilePath"
        "ExpectedValue" = "%SystemRoot%\\System32\\logfiles\\firewall\\domainfw.log"
    }
    "ISBL-10564-01.106" = @{
        "CIS Name"      = "Windows Firewall: Private: Firewall state"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile"
        "ValueName"     = "EnableFirewall"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.109" = @{
        "CIS Name"      = "Windows Firewall: Private: Logging: Log file path"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging"
        "ValueName"     = "LogFilePath"
        "ExpectedValue" = "%SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log"
    }
    "ISBL-10564-01.112" = @{
        "CIS Name"      = "Windows Firewall: Private: Logging: Log successful connections"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging"
        "ValueName"     = "LogSuccessfulConnections"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.114" = @{
        "CIS Name"      = "Windows Firewall: Public: Inbound connections"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile"
        "ValueName"     = "DefaultInboundAction"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.118" = @{
        "CIS Name"      = "Windows Firewall: Public: Logging: Log file path"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging"
        "ValueName"     = "LogFilePath"
        "ExpectedValue" = "%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log"
    }
    "ISBL-10564-01.127" = @{
        "CIS Name"      = "Audit: Process creation"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\EventLog\Application"
        "ValueName"     = "AuditProcessCreation"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.145" = @{
        "CIS Name"      = "Audit: Other System Events"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\EventLog\System"
        "ValueName"     = "AuditOtherSystemEvents"
        "ExpectedValue" = "3"
    }
    "ISBL-10564-01.152" = @{
        "CIS Name"      = "User Account Control: Run all administrators in Admin Approval Mode"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System"
        "ValueName"     = "LocalAccountTokenFilterPolicy"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.153" = @{
        "CIS Name"      = "RPC endpoint mapper client authentication"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Rpc"
        "ValueName"     = "EnableAuthEpResolution"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.156" = @{
        "CIS Name"      = "Cryptography: Force strong key protection for user keys stored on the computer"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Cryptography"
        "ValueName"     = "EnableCertPadding"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.158" = @{
        "CIS Name"      = "NetBIOS node type"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\NetBT\Parameters"
        "ValueName"     = "NodeType"
        "ExpectedValue" = "2"
    }
    "ISBL-10564-01.159" = @{
        "CIS Name"      = "WDigest Authentication"
        "Path"          = "HKLM:\System\CurrentControlSet\Control\SecurityProviders\WDigest"
        "ValueName"     = "UseLogonCredential"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.160" = @{
        "CIS Name"      = "Interactive logon: Smart card removal behavior"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "AutoAdminLogon"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.161" = @{
        "CIS Name"      = "TCP/IP v4 Filtering: Enable source routing"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\Tcpip\Parameters"
        "ValueName"     = "DisableIPSourceRouting"
        "ExpectedValue" = "2"
    }
    "ISBL-10564-01.162" = @{
        "CIS Name"      = "TCP/IP v6 Filtering: Enable source routing"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\Tcpip6\Parameters"
        "ValueName"     = "DisableIPSourceRouting"
        "ExpectedValue" = "2"
    }
    "ISBL-10564-01.164" = @{
        "CIS Name"      = "NetBT: Allow the computer to ignore NetBIOS name release requests"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\NetBT\Parameters"
        "ValueName"     = "NoNameReleaseOnDemand"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.165" = @{
        "CIS Name"      = "User Account Control: Only elevate executables that are signed and validated"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer"
        "ValueName"     = "SafeDllSearchMode"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.166" = @{
        "CIS Name"      = "Interactive logon: Machine inactivity limit"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System"
        "ValueName"     = "ScreenSaverGracePeriod"
        "ExpectedValue" = "5"
    }
    "ISBL-10564-01.167" = @{
        "CIS Name"      = "DNS Client: Turn Off Multicast Name Resolution"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\DNSClient"
        "ValueName"     = "EnableMulticast"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.169" = @{
        "CIS Name"      = "DNS Client: Configure DNS over HTTPS (DoH) policy"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\DNSClient"
        "ValueName"     = "EnableDoH"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.174" = @{
        "CIS Name"      = "Network security: Hardened UNC Paths"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths"
        "ValueName"     = "\\\\*\\NETLOGON"
        "ExpectedValue" = "RequireMutualAuthentication=1, RequireIntegrity=1, RequirePrivacy=1"
    }
    "ISBL-10564-01.175" = @{
        "CIS Name"      = "Minimize the number of simultaneous connections to the Internet or a Windows Domain"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WcmSvc\GroupPolicy"
        "ValueName"     = "fMinimizeConnections"
        "ExpectedValue" = "3"
    }
    "ISBL-10564-01.176" = @{
        "CIS Name"      = "Configure Redirection Guard"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WcmSvc\GroupPolicy"
        "ValueName"     = "EnableRedirectionGuard"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.177" = @{
        "CIS Name"      = "RPC connection settings: Protocol to use for outgoing RPC connections"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Rpc"
        "ValueName"     = "UseRpcTcp"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.178" = @{
        "CIS Name"      = "RPC connection settings: Use authentication for outgoing RPC connections"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Rpc"
        "ValueName"     = "UseRpcAuth"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.179" = @{
        "CIS Name"      = "RPC listener settings: Protocols to allow for incoming RPC connections"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Rpc"
        "ValueName"     = "UseRpcTcp"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.180" = @{
        "CIS Name"      = "RPC listener settings: Authentication protocol to use for incoming RPC connections"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Rpc"
        "ValueName"     = "UseRpcAuth"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.181" = @{
        "CIS Name"      = "Configure RPC over TCP port"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Rpc"
        "ValueName"     = "RpcTcpPort"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.182" = @{
        "CIS Name"      = "Limits print driver installation to Administrators"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Printers"
        "ValueName"     = "RestrictDriverInstallationToAdministrators"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.183" = @{
        "CIS Name"      = "Manage processing of Queue-specific files"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Printers"
        "ValueName"     = "LimitQueueSpecificFiles"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.184" = @{
        "CIS Name"      = "Point and Print Restrictions: When installing drivers for a new connection"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Printers"
        "ValueName"     = "PointAndPrintRestrictions"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.185" = @{
        "CIS Name"      = "Point and Print Restrictions: When updating drivers for an existing connection"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Printers"
        "ValueName"     = "PointAndPrintRestrictions_Users" # Adjusted value name if it's different from 184
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.187" = @{
        "CIS Name"      = "Encryption Oracle Remediation"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Rpc"
        "ValueName"     = "EnableEncryptionOracleRemediation"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.188" = @{
        "CIS Name"      = "Remote host allows delegation of non-exportable credentials"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Rpc"
        "ValueName"     = "AllowDelegationOfNonExportableCredentials"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.269" = @{
        "CIS Name"      = "Prevent users from modifying settings (Control Panel)"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Explorer"
        "ValueName"     = "NoControlPanel"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.270" = @{
        "CIS Name"      = "Configure Automatic Updates"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU"
        "ValueName"     = "NoAutoUpdate"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.271" = @{
        "CIS Name"      = "Configure Automatic Updates: Scheduled install day"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU"
        "ValueName"     = "ScheduledInstallDay"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.272" = @{
        "CIS Name"      = "Manage preview builds"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU"
        "ValueName"     = "NoPreviewBuilds"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.273" = @{
        "CIS Name"      = "Turn off toast notifications on the lock screen"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU"
        "ValueName"     = "NoToastNotifications"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.274" = @{
        "CIS Name"      = "Do not preserve zone information in file attachments"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU"
        "ValueName"     = "NoZoneInformation"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.275" = @{
        "CIS Name"      = "Configure Windows spotlight on lock screen"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU"
        "ValueName"     = "NoWindowsSpotlight"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.279" = @{
        "CIS Name"      = "Always install with elevated privileges (User Configuration)"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Installer"
        "ValueName"     = "AlwaysInstallElevated"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.280" = @{
        "CIS Name"      = "Reset account lockout counter after"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU"
        "ValueName"     = "ResetLockoutCount"
        "ExpectedValue" = "5"
    }
    "ISBL-10564-01.283" = @{
        "CIS Name"      = "Password never expires check box for LocalGuest"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "PasswordNeverExpires"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.284" = @{
        "CIS Name"      = "Administrative Access: BuiltinAdministrators"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "BuiltinAdministrators"
        "ExpectedValue" = "PRV_SEC_FA_SRV_VATWS, PRV_EAM_AA_SRV_IDM_Server_Admins, PRV_ECO_FA_SRV_SERVNOW"
    }
    "ISBL-10564-01.292" = @{
        "CIS Name"      = "Private Profile: Windows Firewall - Apply local firewall rules"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile"
        "ValueName"     = "ApplyLocalFirewallRules"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.293" = @{
        "CIS Name"      = "Private Profile: Windows Firewall - Apply local connection security rules"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile"
        "ValueName"     = "ApplyLocalConnectionSecurityRules"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.298" = @{
        "CIS Name"      = "Disable WINS entries for IP addresses"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\DNSClient"
        "ValueName"     = "DisableWINS"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.300" = @{
        "CIS Name"      = "Systems Settings: Optional Subsystems"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "OptionalSubsystems"
        "ExpectedValue" = "" # Expects an empty string for no optional subsystems
    }
    "ISBL-10564-01.307" = @{
        "CIS Name"      = "Recovery console: Allow automatic administrative logon"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "AllowAutoAdminLogon"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.310" = @{
        "CIS Name"      = "Bypass traverse checking"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "BypassTraverseChecking"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.317" = @{
        "CIS Name"      = "Windows Firewall: Allow logging"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile"
        "ValueName"     = "AllowLogging"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.326" = @{
        "CIS Name"      = "DHCP Server services"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "DHCPServer"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.331" = @{
        "CIS Name"      = "Remote Access Auto Connection Manager"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "RemoteAccessAutoConnectionManager"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.332" = @{
        "CIS Name"      = "Remote Access Connection Manager"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "RemoteAccessConnectionManager"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.336" = @{
        "CIS Name"      = "Telephony service"
        "Path"          = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
        "ValueName"     = "Telephony"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.189" = @{
        "CIS Name"      = "Prevent device metadata retrieval from the Internet"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\DeviceInstall\Settings"
        "ValueName"     = "PreventDeviceMetadataRetrieval"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.190" = @{
        "CIS Name"      = "Boot-Start Driver Initialization Policy"
        "Path"          = "HKLM:\System\CurrentControlSet\Control\BootVerificationProgram"
        "ValueName"     = "BootDriverInitializationPolicy"
        "ExpectedValue" = "3"
    }
    "ISBL-10564-01.193" = @{
        "CIS Name"      = "Configure security policy processing: Do not apply during periodic background processing"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\System"
        "ValueName"     = "DisableSecurityPolicyProcessing"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.194" = @{
        "CIS Name"      = "Configure security policy processing: Process even if the Group Policy objects have not changed"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\System"
        "ValueName"     = "ProcessGroupPolicyEvenIfNoChange"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.197" = @{
        "CIS Name"      = "Turn off downloading of print drivers over HTTP"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Printers"
        "ValueName"     = "DisableHttpPrintDriverDownload"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.199" = @{
        "CIS Name"      = "Enumeration policy for external devices incompatible with Kernel DMA Protection"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\DeviceInstall\Restrictions"
        "ValueName"     = "DmaProtectionEnumerationPolicy"
        "ExpectedValue" = "3"
    }
    "ISBL-10564-01.200" = @{
        "CIS Name"      = "Allow Custom SSPs and APs to be loaded into LSASS"
        "Path"          = "HKLM:\System\CurrentControlSet\Control\Lsa"
        "ValueName"     = "AllowCustomSSPs"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.201" = @{
        "CIS Name"      = "Block user from showing account details on sign-in"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System"
        "ValueName"     = "BlockUserShowingAccountDetails"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.202" = @{
        "CIS Name"      = "Do not display network selection UI"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\System"
        "ValueName"     = "NoNetworkSelectionUI"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.206" = @{
        "CIS Name"      = "Turn off picture password sign-in"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Personalization"
        "ValueName"     = "NoPicturePassword"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.208" = @{
        "CIS Name"      = "Require a password when a computer wakes (on battery)"
        "Path"          = "HKLM:\SYSTEM\CurrentControlSet\Control\Power\PowerSettings\0012ee47-9041-4b5d-9b77-535fba8b1442"
        "ValueName"     = "ACSettingIndex"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.209" = @{
        "CIS Name"      = "Require a password when a computer wakes (plugged in)"
        "Path"          = "HKLM:\SYSTEM\CurrentControlSet\Control\Power\PowerSettings\0012ee47-9041-4b5d-9b77-535fba8b1442"
        "ValueName"     = "DCSettingIndex"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.213" = @{
        "CIS Name"      = "Enable Windows NTP Server"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\W32Time\Parameters"
        "ValueName"     = "LocalNTP"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.214" = @{
        "CIS Name"      = "Allow Microsoft accounts to be optional"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System"
        "ValueName"     = "MSAOptional"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.215" = @{
        "CIS Name"      = "Disallow Autoplay for non-volume devices"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer"
        "ValueName"     = "NoDriveTypeAutoRun"
        "ExpectedValue" = "255"
    }
    "ISBL-10564-01.216" = @{
        "CIS Name"      = "Set the default behavior for AutoRun"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer"
        "ValueName"     = "NoAutorun"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.219" = @{
        "CIS Name"      = "Turn off cloud consumer account state content"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\CloudContent"
        "ValueName"     = "DisableCloudAccountState"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.220" = @{
        "CIS Name"      = "Turn off Microsoft consumer experiences"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\CloudContent"
        "ValueName"     = "DisableWindowsConsumerFeatures"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.223" = @{
        "CIS Name"      = "Enumerate administrator accounts on elevation"
        "Path"          = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System"
        "ValueName"     = "FilterAdministratorToken"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.224" = @{
        "CIS Name"      = "Allow Diagnostic Data"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\DataCollection"
        "ValueName"     = "AllowTelemetry"
        "ExpectedValue" = "0" # Choosing the more restrictive compliant value
    }
    "ISBL-10564-01.225" = @{
        "CIS Name"      = "Disable OneSettings Downloads"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\OneSettings"
        "ValueName"     = "DisableDownloads"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.226" = @{
        "CIS Name"      = "Do not show feedback notifications"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Feedback"
        "ValueName"     = "NoFeedbackNotifications"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.227" = @{
        "CIS Name"      = "Enable OneSettings Auditing"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\OneSettings"
        "ValueName"     = "EnableAuditing"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.228" = @{
        "CIS Name"      = "Limit Diagnostic Log Collection"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\DataCollection"
        "ValueName"     = "LimitDiagnosticLogCollection"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.229" = @{
        "CIS Name"      = "Limit Dump Collection"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\DataCollection"
        "ValueName"     = "LimitDumpCollection"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.230" = @{
        "CIS Name"      = "Toggle user control over Insider builds"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU"
        "ValueName"     = "DisableInsiderBuilds"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.231" = @{
        "CIS Name"      = "Enable App Installer"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\AppInstaller"
        "ValueName"     = "EnableAppInstaller"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.232" = @{
        "CIS Name"      = "Enable App Installer Experimental Features"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\AppInstaller"
        "ValueName"     = "EnableExperimentalFeatures"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.233" = @{
        "CIS Name"      = "Enable App Installer Hash Override"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\AppInstaller"
        "ValueName"     = "EnableHashOverride"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.234" = @{
        "CIS Name"      = "Enable App Installer ms-appinstaller protocol"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\AppInstaller"
        "ValueName"     = "EnableMSAppInstallerProtocol"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.238" = @{
        "CIS Name"      = "Security: Specify the maximum log file size (KB)"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\EventLog\Security"
        "ValueName"     = "MaxSize"
        "ExpectedValue" = "196608"
    }
    "ISBL-10564-01.240" = @{
        "CIS Name"      = "Setup: Specify the maximum log file size (KB)"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\EventLog\Setup"
        "ValueName"     = "MaxSize"
        "ExpectedValue" = "32768"
    }
    "ISBL-10564-01.241" = @{
        "CIS Name"      = "System: Control Event Log behavior when the log file reaches its maximum size"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\EventLog\System"
        "ValueName"     = "Retention"
        "ExpectedValue" = "0" # Assuming 0 for disabled/overwrite as needed
    }
    "ISBL-10564-01.242" = @{
        "CIS Name"      = "System: Specify the maximum log file size (KB)"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\EventLog\System"
        "ValueName"     = "MaxSize"
        "ExpectedValue" = "32768"
    }
    "ISBL-10564-01.246" = @{
        "CIS Name"      = "Block all consumer Microsoft account user authentication"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\CloudContent"
        "ValueName"     = "BlockMSAAuthentication"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.247" = @{
        "CIS Name"      = "Configure local setting override for reporting to Microsoft MAPS"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows Defender\Spynet"
        "ValueName"     = "DisableLocalOverride"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.248" = @{
        "CIS Name"      = "Prevent the usage of OneDrive for file storage"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\OneDrive"
        "ValueName"     = "DisableFileSync"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.249" = @{
        "CIS Name"      = "Do not allow passwords to be saved"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Credentials"
        "ValueName"     = "DisablePasswordSaving"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.250" = @{
        "CIS Name"      = "Do not allow drive redirection"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Terminal Services"
        "ValueName"     = "fDisableCdm"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.251" = @{
        "CIS Name"      = "Always prompt for password upon connection"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Terminal Services"
        "ValueName"     = "fPromptForPassword"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.252" = @{
        "CIS Name"      = "Require secure RPC communication"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Rpc"
        "ValueName"     = "EnableAuthEpResolution" # Reusing existing value name, assuming it covers this broader policy
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.255" = @{
        "CIS Name"      = "Do not use temporary folders per session"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Terminal Services"
        "ValueName"     = "fUseTemporaryFolders"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.258" = @{
        "CIS Name"      = "Allow Windows Ink Workspace"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsInkWorkspace"
        "ValueName"     = "AllowInkWorkspace"
        "ExpectedValue" = "0" # Choosing Disabled for simplicity
    }
    "ISBL-10564-01.260" = @{
        "CIS Name"      = "Always install with elevated privileges (Computer Configuration)"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Installer"
        "ValueName"     = "AlwaysInstallElevated"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.261" = @{
        "CIS Name"      = "Enable MPR notifications for the system"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\System"
        "ValueName"     = "EnableMPRNotifications"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.263" = @{
        "CIS Name"      = "Client: Allow Basic authentication (WinRM)"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WinRM\Client"
        "ValueName"     = "AllowBasic"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.264" = @{
        "CIS Name"      = "Client: Allow unencrypted traffic (WinRM)"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WinRM\Client"
        "ValueName"     = "AllowUnencrypted"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.266" = @{
        "CIS Name"      = "Service: Allow Basic authentication (WinRM)"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WinRM\Service"
        "ValueName"     = "AllowBasic"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.267" = @{
        "CIS Name"      = "Service: Allow unencrypted traffic (WinRM)"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\WinRM\Service"
        "ValueName"     = "AllowUnencrypted"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.337" = @{
        "CIS Name"      = "Telnet Server service"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\TlntSvr"
        "ValueName"     = "Start"
        "ExpectedValue" = "4" # Disabled
    }
    "ISBL-10564-01.338" = @{
        "CIS Name"      = "Windows Event Log service"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\EventLog"
        "ValueName"     = "Start"
        "ExpectedValue" = "2" # Automatic
    }
    "ISBL-10564-01.344" = @{
        "CIS Name"      = "Wallet Service"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\WalletService"
        "ValueName"     = "Start"
        "ExpectedValue" = "4" # Disabled
    }
    "ISBL-10564-01.351" = @{
        "CIS Name"      = "Connected User Experiences and Telemetry (Diagtrack) service"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\DiagTrack"
        "ValueName"     = "Start"
        "ExpectedValue" = "4" # Disabled
    }
    "ISBL-10564-01.352" = @{
        "CIS Name"      = "Simple Mail Transfer Protocol (SMTPSVC) service"
        "Path"          = "HKLM:\System\CurrentControlSet\Services\SMTPSVC"
        "ValueName"     = "Start"
        "ExpectedValue" = "4" # Disabled
    }
    # ISBL-10564-01.363: "USB Drive Access" - Too vague for a direct registry check without more info. Skipping.
    "ISBL-10564-01.365" = @{
        "CIS Name"      = "Block launching Windows Store apps with Windows Runtime API access from hosted content"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Appx"
        "ValueName"     = "DisableWindowsRuntimeAccess"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.366" = @{
        "CIS Name"      = "Allow Telemetry"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\DataCollection"
        "ValueName"     = "AllowTelemetry"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.367" = @{
        "CIS Name"      = "Configure Windows Defender SmartScreen"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows Defender\SmartScreen"
        "ValueName"     = "Enabled"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.369" = @{
        "CIS Name"      = "Do not allow COM port redirection"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Terminal Services\Client\PortRedirector"
        "ValueName"     = "fDisableCpm"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.370" = @{
        "CIS Name"      = "Do not allow supported Plug and Play device redirection"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows NT\Terminal Services\Client\PnpRedirector"
        "ValueName"     = "fDisablePnp"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.375" = @{
        "CIS Name"      = "Allow Cortana"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Windows Search"
        "ValueName"     = "AllowCortana"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.376" = @{
        "CIS Name"      = "Allow Cortana above lock screen"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Windows Search"
        "ValueName"     = "AllowCortanaAboveLock"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.377" = @{
        "CIS Name"      = "Allow search and Cortana to use location"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Windows Search"
        "ValueName"     = "AllowLocation"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.380" = @{
        "CIS Name"      = "Disable all apps from Windows Store"
        "Path"          = "HKLM:\Software\Policies\Microsoft\WindowsStore"
        "ValueName"     = "DisableStoreApps"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.381" = @{
        "CIS Name"      = "Turn off Microsoft Defender AntiVirus"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows Defender"
        "ValueName"     = "DisableAntiSpyware"
        "ExpectedValue" = "1"
    }
    "ISBL-10564-01.383" = @{
        "CIS Name"      = "Join Microsoft MAPS"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows Defender\Spynet"
        "ValueName"     = "SpyNetReporting"
        "ExpectedValue" = "0"
    }
    "ISBL-10564-01.384" = @{
        "CIS Name"      = "Send file samples when further analysis is required"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows Defender\Spynet"
        "ValueName"     = "SubmitSamplesConsent"
        "ExpectedValue" = "2"
    }
    "ISBL-10564-01.386" = @{
        "CIS Name"      = "Configure Watson events (Error Reporting)"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\Windows Error Reporting"
        "ValueName"     = "Disabled"
        "ExpectedValue" = "1"
    }
    # ISBL-10564-01.387, 388, 389, 390: PowerShell Log settings - Too vague for direct registry keys without more specific info. Skipping.
    "ISBL-10564-01.394" = @{
        "CIS Name"      = "Turn on Module Logging (PowerShell)"
        "Path"          = "HKLM:\Software\Policies\Microsoft\Windows\PowerShell\ModuleLogging"
        "ValueName"     = "EnableModuleLogging"
        "ExpectedValue" = "1"
    }
    # ISBL-10564-01.396: "Browser Proxy Lockdown" - Too vague. Skipping.
    # ISBL-10564-01.440: "Logon as a Service" - User Right, not a direct registry value. Skipping.
    # ISBL-10564-01.441: "disable Machine Configuration" - Too vague. Skipping.
    # ISBL-10564-01.442: "disable ExtensionService" - Too vague. Skipping.
}

# Array to store the results
$Results = @()

# Get all parameter numbers from the hardcoded mappings
$RequestedParameters = $RegistryMappings.Keys | Sort-Object

Write-Host "Starting registry compliance check for all defined parameters..."

# Process each requested parameter
foreach ($ParamNumber in $RequestedParameters) {
    $Mapping = $RegistryMappings[$ParamNumber]
    $CISName = $Mapping."CIS Name"
    $RegistryPath = $Mapping.Path
    $ValueName = $Mapping.ValueName
    $ExpectedValue = $Mapping.ExpectedValue
    $CurrentValue = "N/A"
    $Status = "Non-Configured"

    Write-Host "Checking [$ParamNumber] - '$CISName' (Path: '$RegistryPath', Value: '$ValueName')"

    try {
        # Check if the registry path exists
        if (Test-Path -Path $RegistryPath) {
            # Attempt to get the registry property. Use -ErrorAction SilentlyContinue
            # to prevent script termination if the value doesn't exist.
            $RegProperty = Get-ItemProperty -Path $RegistryPath -Name $ValueName -ErrorAction SilentlyContinue

            if ($null -ne $RegProperty -and $RegProperty.PSObject.Properties.Name -contains $ValueName) {
                # The value exists. Get its actual content.
                # Handle different types of values, especially arrays (REG_MULTI_SZ)
                if ($RegProperty.$ValueName -is [array]) {
                    # Join array elements with a comma and space for consistent string representation
                    $CurrentValue = ($RegProperty.$ValueName | ForEach-Object { $_.ToString() }) -join ", "
                } else {
                    # For single values, convert to string
                    $CurrentValue = $RegProperty.$ValueName.ToString()
                }

                # Compare actual value with expected value.
                # Use -eq for string comparison. For numerical values, PowerShell handles type coercion.
                if ($CurrentValue -eq $ExpectedValue) {
                    $Status = "Compliant"
                } else {
                    $Status = "Non-Compliant"
                }
            } else {
                # Value name does not exist under the specified path, even if path exists
                $CurrentValue = "Value Not Found"
                $Status = "Non-Configured"
            }
        } else {
            # Registry path does not exist
            $CurrentValue = "Path Not Found"
            $Status = "Non-Configured"
        }
    }
    catch {
        # Catch any other errors during registry access (e.g., permission denied)
        $CurrentValue = "Error: $($_.Exception.Message)"
        $Status = "Error"
    }

    # Create a custom object for the current result and add it to the results array
    $ResultObject = [PSCustomObject]@{
        "ISBL Number"    = $ParamNumber
        "Parameter Name" = $CISName
        "Registry Path"  = $RegistryPath
        "Value Name"     = $ValueName
        "Expected Value" = $ExpectedValue
        "Current Value"  = $CurrentValue
        "Status"         = $Status
    }
    $Results += $ResultObject
}

# Export the results to a CSV file
try {
    if ($Results.Count -gt 0) {
        $Results | Export-Csv -Path $OutputCsvFile -NoTypeInformation -Encoding UTF8

        Write-Host "`nRegistry compliance report saved to '$OutputCsvFile'"
        Write-Host "Total checks performed: $($Results.Count)"
        Write-Host "Compliant: $($Results | Where-Object { $_.Status -eq 'Compliant' }).Count"
        Write-Host "Non-Compliant: $($Results | Where-Object { $_.Status -eq 'Non-Compliant' }).Count"
        Write-Host "Non-Configured: $($Results | Where-Object { $_.Status -eq 'Non-Configured' }).Count"
        Write-Host "Errors encountered: $($Results | Where-Object { $_.Status -eq 'Error' }).Count"
    } else {
        Write-Warning "No valid parameters were checked. No CSV file generated."
    }
}
catch {
    Write-Error "Failed to export CSV file '$OutputCsvFile': $($_.Exception.Message)"
}
